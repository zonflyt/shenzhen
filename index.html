<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>深圳 · 山海连城：城市建成区变化 (1985-2020)</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        * { box-sizing: border-box; }
        
        body {
            margin: 0;
            padding: 0; /* 移除内边距，实现全屏 */
            background-color: #f0ebe5;
            font-family: 'Noto Serif SC', serif;
            color: #5d5d5d;
            overflow: hidden; /* 防止出现滚动条 */
            height: 100vh;
            width: 100vw;
        }

        .main-wrapper {
            width: 100%;
            height: 100%;
            position: relative;
        }

        .scroll-container {
            width: 100%;
            height: 100%; /* 撑满高度 */
            background: #fffcf5;
            position: relative;
            /* 移除之前的边框和阴影，因为现在是全屏背景 */
            border: none;
            border-radius: 0;
        }

        .texture-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            opacity: 0.04; /* 稍微加深一点纹理 */
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
            pointer-events: none;
            z-index: 0;
        }

        .header-info {
            position: absolute;
            top: 30px;
            left: 40px;
            z-index: 10;
            pointer-events: none; /* 让鼠标事件穿透到图表 */
        }

        h1 {
            margin: 0;
            font-size: clamp(1.5rem, 4vw, 2.2rem); /* 稍微调大字体 */
            color: #2c3e50;
            letter-spacing: 0.1em;
            text-shadow: 2px 2px 0px rgba(255,255,255,0.8);
        }

        .subtitle {
            margin-top: 8px;
            font-size: 1rem;
            color: #888;
            font-style: italic;
        }

        .controls {
            position: absolute;
            top: 30px;
            right: 40px;
            z-index: 10;
        }

        .btn {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid #aaa;
            padding: 10px 20px;
            font-family: 'Noto Serif SC', serif;
            cursor: pointer;
            border-radius: 30px;
            transition: all 0.2s;
            font-size: 0.9rem;
            color: #555;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            backdrop-filter: blur(5px);
        }

        .btn:hover {
            background: #2c3e50;
            color: white;
            border-color: #2c3e50;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .btn:active {
            transform: scale(0.98);
        }

        #chart {
            width: 100%;
            height: 100%;
            position: relative;
            z-index: 1;
        }

        .footer-note {
            position: absolute;
            bottom: 20px;
            left: 0;
            right: 0;
            font-size: 0.85rem;
            color: #999;
            text-align: center;
            z-index: 10;
            pointer-events: none;
            text-shadow: 0 1px 2px rgba(255,255,255,0.8);
        }
    </style>
</head>
<body>

    <div class="main-wrapper">
        <div class="scroll-container">
            <div class="texture-overlay"></div>
            <div class="header-info">
                <!-- 标题已更新 -->
                <h1>深圳 · 山海连城：城市建成区变化</h1>
                <div class="subtitle">Shenzhen Urban Expansion & Built-up Area (1985-2020)</div>
            </div>
            <div class="controls">
                <button class="btn" onclick="replay()">重绘长卷 / Replay</button>
            </div>
            <div id="chart"></div>
            <div class="footer-note">
                数据来源：EE-Chart Dataset · 单位：平方公里 (km²) · 包含 1985-2013 实测数据及后续趋势推演
            </div>
        </div>
    </div>

    <script>
        // ===== 数据准备 =====
        const rawData = [
            {year: '1985', value: 47.33},
            {year: '1986', value: 54.1}, 
            {year: '1987', value: 60.9}, 
            {year: '1988', value: 67.8}, 
            {year: '1989', value: 71.2},
            {year: '1990', value: 74.68},
            {year: '1991', value: 98.34},
            {year: '1992', value: 120.09},
            {year: '1993', value: 164.31},
            {year: '1994', value: 195.26},
            {year: '1995', value: 227.78},
            {year: '1996', value: 265.66},
            {year: '1997', value: 305.77},
            {year: '1998', value: 342.82},
            {year: '1999', value: 381.36},
            {year: '2000', value: 425.67},
            {year: '2001', value: 446.72},
            {year: '2002', value: 479.10},
            {year: '2003', value: 510.54},
            {year: '2004', value: 543.76},
            {year: '2005', value: 584.83},
            {year: '2006', value: 615.19},
            {year: '2007', value: 635.84},
            {year: '2008', value: 652.39},
            {year: '2009', value: 669.51},
            {year: '2010', value: 681.61},
            {year: '2011', value: 691.40},
            {year: '2012', value: 699.51},
            {year: '2013', value: 711.53},
            {year: '2014', value: 725.2},
            {year: '2015', value: 738.5},
            {year: '2016', value: 752.1},
            {year: '2017', value: 765.8},
            {year: '2018', value: 778.3},
            {year: '2019', value: 789.5},
            {year: '2020', value: 802.1} 
        ];

        const xData = rawData.map(item => item.year);
        const yData = rawData.map(item => item.value);

        // ===== 自定义SVG符号 =====
        function createSymbols() {
            return {
                boat: 'image://data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40"><path d="M8 28 Q20 32 32 28 L30 20 Q20 24 10 20 Z" fill="none" stroke="currentColor" stroke-width="1.5"/><line x1="20" y1="20" x2="20" y2="8" stroke="currentColor" stroke-width="1"/></svg>',
                crane: 'image://data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40"><rect x="6" y="4" width="28" height="24" fill="none" stroke="currentColor" stroke-width="1.5"/><line x1="12" y1="4" x2="12" y2="2" stroke="currentColor" stroke-width="1"/><line x1="20" y1="4" x2="20" y2="0" stroke="currentColor" stroke-width="1"/><line x1="28" y1="4" x2="28" y2="2" stroke="currentColor" stroke-width="1"/><circle cx="20" cy="28" r="4" fill="none" stroke="currentColor" stroke-width="1"/></svg>',
                chip: 'image://data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40"><rect x="8" y="8" width="24" height="24" fill="none" stroke="currentColor" stroke-width="1.5"/><rect x="12" y="12" width="16" height="16" fill="none" stroke="currentColor" stroke-width="1"/><line x1="8" y1="12" x2="4" y2="12" stroke="currentColor" stroke-width="1"/><line x1="8" y1="20" x2="4" y2="20" stroke="currentColor" stroke-width="1"/><line x1="8" y1="28" x2="4" y2="28" stroke="currentColor" stroke-width="1"/></svg>',
                metro: 'image://data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40"><path d="M10 34 L30 34 L32 10 L8 10 Z" fill="none" stroke="currentColor" stroke-width="1.5"/><rect x="12" y="14" width="16" height="10" rx="1" fill="none" stroke="currentColor" stroke-width="1"/><circle cx="12" cy="28" r="2" fill="currentColor"/><circle cx="28" cy="28" r="2" fill="currentColor"/><line x1="16" y1="34" x2="24" y2="34" stroke="currentColor" stroke-width="2"/></svg>',
                port: 'image://data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40"><path d="M4 32 L36 32 L34 36 L6 36 Z" fill="none" stroke="currentColor" stroke-width="1.5"/><rect x="12" y="20" width="10" height="12" fill="none" stroke="currentColor" stroke-width="1"/><line x1="12" y1="26" x2="22" y2="26" stroke="currentColor" stroke-width="0.8"/></svg>',
                city: 'image://data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40"><rect x="10" y="12" width="8" height="20" fill="none" stroke="currentColor" stroke-width="1.5"/><rect x="22" y="8" width="8" height="24" fill="none" stroke="currentColor" stroke-width="1.5"/><circle cx="14" cy="16" r="1" fill="currentColor"/><circle cx="14" cy="22" r="1" fill="currentColor"/><circle cx="26" cy="12" r="1" fill="currentColor"/><circle cx="26" cy="20" r="1" fill="currentColor"/></svg>'
            };
        }

        const symbols = createSymbols();

        // ===== ECharts 初始化 =====
        const myChart = echarts.init(document.getElementById('chart'));

        // ===== 背景图形 =====
        const bgGraphics = [
            // 远山 (位置略微调整以适应全屏)
            {
                type: 'polygon',
                shape: {
                    points: [
                        [0, 0.55], [0.15, 0.45], [0.35, 0.57], [0.5, 0.40],
                        [0.7, 0.53], [0.85, 0.43], [1, 0.50], [1, 1], [0, 1]
                    ]
                },
                style: {
                    fill: '#e6e8e6',
                    stroke: 'none'
                },
                left: 0,
                top: 0,
                right: 0,
                bottom: '15%',
                z: -10
            },
            // 中景山
            {
                type: 'polygon',
                shape: {
                    points: [
                        [0, 0.65], [0.2, 0.58], [0.4, 0.68], [0.6, 0.55],
                        [0.8, 0.65], [1, 0.6], [1, 1], [0, 1]
                    ]
                },
                style: {
                    fill: 'rgba(189, 195, 199, 0.25)',
                    stroke: 'none'
                },
                left: 0,
                top: '25%',
                right: 0,
                bottom: 0,
                z: -8
            },
            // 近景：海浪
            {
                type: 'polygon',
                shape: {
                    points: [
                       [0, 0.85], [0.1, 0.88], [0.2, 0.84], [0.3, 0.89],
                       [0.4, 0.85], [0.5, 0.88], [0.6, 0.83], [0.7, 0.89],
                       [0.8, 0.84], [0.9, 0.88], [1, 0.85], [1, 1], [0, 1]
                    ],
                    smooth: 0.5
                },
                style: {
                    fill: 'rgba(52, 152, 219, 0.05)',
                    stroke: 'none'
                },
                left: 0,
                top: '55%',
                right: 0,
                bottom: 0,
                z: -5
            }
        ];

        // ===== 图表配置 =====
        const option = {
            backgroundColor: 'transparent',
            graphic: bgGraphics,
            grid: {
                top: '25%', // 给标题留出更多空间
                bottom: '12%',
                left: '5%',
                right: '4%',
                containLabel: true
            },
            tooltip: {
                trigger: 'axis',
                backgroundColor: 'rgba(255, 252, 245, 0.98)',
                borderColor: '#d35400',
                borderWidth: 1,
                padding: 12,
                textStyle: {
                    fontFamily: 'Noto Serif SC',
                    color: '#333',
                    fontSize: 13
                },
                formatter: function(params) {
                    if (!params || params.length === 0) return '';
                    const item = params[0];
                    return `<div style="text-align:center"><span style="font-weight:bold;font-size:1.1em">${item.axisValue}</span><br/><span style="color:#e67e22;font-size:1.3em">●</span> ${item.value} km²</div>`;
                }
            },
            dataZoom: [
                {
                    type: 'inside',
                    start: 0,
                    end: 100,
                    zoomOnMouseWheel: 'shift'
                },
                {
                    type: 'slider',
                    show: true,
                    bottom: 40, // 稍微上移，避开底部文字
                    height: 10,
                    borderColor: 'transparent', // 更加隐形
                    backgroundColor: '#f5f5f5',
                    fillerColor: 'rgba(44, 62, 80, 0.1)',
                    handleStyle: {
                        color: '#2c3e50',
                        borderColor: '#fff'
                    },
                    moveHandleSize: 6
                }
            ],
            xAxis: {
                type: 'category',
                boundaryGap: false,
                data: xData,
                axisLine: {
                    lineStyle: { color: '#7f8c8d', width: 1.5 }
                },
                axisTick: { show: false },
                axisLabel: {
                    fontFamily: 'Noto Serif SC',
                    color: '#666',
                    interval: 4,
                    margin: 14,
                    fontSize: 12
                }
            },
            yAxis: {
                type: 'value',
                splitLine: {
                    show: true,
                    lineStyle: {
                        color: '#e8e8e8',
                        type: [4, 4],
                        dashOffset: 0
                    }
                },
                axisLabel: {
                    fontFamily: 'Noto Serif SC',
                    color: '#999',
                    fontSize: 11
                },
                axisLine: { show: false },
                axisTick: { show: false }
            },
            series: [
                {
                    name: '建成区面积',
                    type: 'line',
                    smooth: true,
                    symbol: 'none',
                    lineStyle: {
                        width: 3, // 加粗线条
                        color: new echarts.graphic.LinearGradient(0, 0, 1, 0, [
                            {offset: 0, color: '#34495e'},
                            {offset: 0.5, color: '#16a085'},
                            {offset: 1, color: '#c0392b'}
                        ])
                    },
                    areaStyle: {
                        color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                            {offset: 0, color: 'rgba(230, 126, 34, 0.35)'},
                            {offset: 0.8, color: 'rgba(230, 126, 34, 0.02)'},
                            {offset: 1, color: 'rgba(255, 255, 255, 0)'}
                        ])
                    },
                    data: yData,
                    markPoint: {
                        symbolSize: [45, 45], // 稍微放大图标
                        label: {
                            show: true,
                            position: 'top',
                            distance: 12,
                            backgroundColor: 'rgba(255,255,255,0.95)',
                            padding: [6, 10],
                            borderRadius: 4,
                            borderColor: '#dcdcdc',
                            borderWidth: 1,
                            color: '#2c3e50',
                            fontFamily: 'Noto Serif SC',
                            fontWeight: 'bold',
                            fontSize: 11,
                            align: 'center',
                            lineHeight: 16,
                            shadowBlur: 5,
                            shadowColor: 'rgba(0,0,0,0.1)',
                            // 关键修改：显示名称和数值
                            formatter: '{b}\n{c} km²'
                        },
                        data: [
                            {coord: ['1985', 47.33], value: 47.33, name: '渔村起步', symbol: symbols.boat, itemStyle: {color: '#34495e'}},
                            {coord: ['1992', 120.09], value: 120.09, name: '建设狂潮', symbol: symbols.crane, itemStyle: {color: '#e67e22'}},
                            {coord: ['2000', 425.67], value: 425.67, name: '高新制造', symbol: symbols.chip, itemStyle: {color: '#27ae60'}},
                            {coord: ['2004', 543.76], value: 543.76, name: '地铁通车', symbol: symbols.metro, itemStyle: {color: '#16a085'}},
                            {coord: ['2011', 691.40], value: 691.40, name: '港口大运', symbol: symbols.port, itemStyle: {color: '#2980b9'}},
                            {coord: ['2020', 802.1], value: 802.1, name: '国际都会', symbol: symbols.city, itemStyle: {color: '#8e44ad'}}
                        ]
                    }
                }
            ],
            animationDuration: 3000,
            animationEasing: 'cubicOut'
        };

        // ===== 渲染 =====
        myChart.setOption(option);

        // 响应式
        window.addEventListener('resize', () => {
            myChart.resize();
        });

        // 重绘
        function replay() {
            myChart.setOption(option, true);
        }
    </script>
</body>
</html>
